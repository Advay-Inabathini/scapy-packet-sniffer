<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <h1>Packet Capture Summary</h1>
    <h2>Total Packets Captured: {{ data.total_packets }}</h2>
    <h3>Capture Duration: {{ data.time }} seconds</h3>

    <h2>Packets Over Time</h2>
    <div id="packets-over-time-chart"></div>
    
    <h2>Protocol Distribution</h2>
    <div id="protocol-chart"></div>
    <ul>
  {% for protocol, count in data.protocol_counts.items() %}
    <li>{{ protocol }}: {{ count }}</li>
  {% endfor %}
</ul>

    <h2>Top Talkers</h2>
<ul>
    {% for packet in data.top_talkers %}
        <li>{{packet.website}} {{ packet.src_domain or packet.src_ip }} ({{ packet.count }} packets)</li>
    {% endfor %}
</ul>

<h2>Insights</h2>
<!-- {{ data.insights|safe }} -->

<h2>Analysis of Captured Packets:</h2>
<p><strong>Overall Traffic:</strong></p>
<ul>
<li><strong>High volume of UDP traffic:</strong>  You have a total of 11,750 packets, with a significant majority (10,415) using the UDP protocol. UDP is often used for real-time applications like streaming or gaming due to its speed, but it lacks the reliability of TCP.</li>
<li><strong>Lower volume of TCP traffic:</strong> There are 1,335 TCP packets, which are typically used for reliable data transmission like web browsing, file transfers, and emails.</li>
</ul>
<p><strong>Top Talkers:</strong></p>
<ul>
<li><strong>Predominantly internal network activity:</strong> Most of the top talkers seem to be within your private network, indicated by private IP addresses (starting with 10.29). This is expected for local network devices communicating with each other.</li>
<li><strong>External communication:</strong> There's also communication with external servers, like the ones associated with "bom07s29-in-f4.1e100.net" and "server-108-158-61-108.bom78.r.cloudfront.net". These could be related to content delivery networks or cloud services.</li>
<li><strong>Device identification:</strong> Some devices are identified by name, like "Advays-A-Sus" and "ANAKIN". These could be computers, mobile devices, or other network-connected equipment.</li>
</ul>
<p><strong>Sample Packets:</strong></p>
<ul>
<li><strong>DNS queries and responses:</strong> Several packets involve DNS (Domain Name System) queries and responses. This is a normal part of network communication, as devices use DNS to translate domain names (like google.com) into IP addresses.</li>
<li><strong>mDNS traffic:</strong> The presence of ".local" domains suggests the use of mDNS (multicast DNS) for service discovery on the local network. This is common for devices like printers or media servers.</li>
<li><strong>NBNS traffic:</strong> We see NBNS (NetBIOS Name Service) traffic, which is used for name resolution in older Windows networks.</li>
</ul>
<p><strong>Potential Concerns:</strong></p>
<ul>
<li><strong>High UDP traffic:</strong>  While UDP is normal for certain applications, a consistently high volume might warrant further investigation, especially if you're not actively using bandwidth-intensive applications. It could indicate background activity or potential malware communication.</li>
<li><strong>Unidentified devices:</strong>  Devices with empty website fields or unclear names should be identified to ensure they are authorized and secure.</li>
<li><strong>External communication:</strong> Analyzing the nature of external communication is crucial to identify any potential risks or unauthorized data transfers.</li>
</ul>
<p><strong>Recommendations:</strong></p>
<ul>
<li><strong>Monitor network activity over time:</strong> Observe if the high UDP traffic persists and investigate any unusual patterns.</li>
<li><strong>Identify unknown devices:</strong> Determine the purpose of devices with unclear information and ensure their security.</li>
<li><strong>Analyze external communication:</strong> Investigate the domains and IP addresses involved in external communication to ensure they are legitimate and trustworthy.</li>
<li><strong>Consider implementing security measures:</strong> Depending on your network environment and concerns, you might consider using firewalls, intrusion detection systems, or other security tools to enhance network protection.</li>
</ul>
<p><strong>Please note that this analysis is based on a limited snapshot of your network traffic. A more comprehensive understanding would require longer-term monitoring and deeper investigation.</strong></p>


    <h2>Sample Packets</h2>
    <table border="1">
        <tr>
            <th>Source IP</th>
            <th>Destination IP</th>
            <th>Protocol</th>
            <th>Length</th>
            <th>Info</th>
        </tr>
        {% for packet in data.sample_packets %}
            <tr>
                <td>{{ packet.src_ip }}</td>
                <td>{{ packet.dst_ip }}</td>
                <td>{{ packet.protocol }}</td>
                <td>{{ packet.length }}</td>
                <td>{{ packet.info }}</td>
            </tr>
        {% endfor %}
    </table>
    
    <a href="/">Back to Home</a>

    <script>
        // JavaScript code to generate protocol distribution chart
        var protocolData = {{ data.protocol_counts|tojson }};
    var protocolLabels = Object.keys(protocolData);
    var protocolValues = Object.values(protocolData);

    var data = [{
        values: protocolValues,
        labels: protocolLabels,
        type: 'pie'
    }];

    var layout = {
        title: 'Protocol Distribution'
    };

    Plotly.newPlot('protocol-chart', data, layout);

    var packetsData = {{ data.packets_per_second|tojson }};
  var timestamps = packetsData.map(x => x[0]);
  var packetCounts = packetsData.map(x => x[1]);

  // Convert timestamps to human-readable format
  var formattedTimestamps = timestamps.map(timestamp => {
    var date = new Date(timestamp * 1000); // Convert Unix epoch to milliseconds
    return date.toLocaleTimeString(); // Convert to local date and time format
  });

  var trace1 = {
    x: formattedTimestamps,
    y: packetCounts,
    mode: 'lines',
    name: 'Packets Received'
  };

  var data = [trace1];

  var layout = {
    title: 'Packets Received Over Time',
    xaxis: {
      title: 'Time'
    },
    yaxis: {
      title: 'Number of Packets'
    }
  };

  Plotly.newPlot('packets-over-time-chart', data, layout);
</script>


    </script>
</body>
</html>
